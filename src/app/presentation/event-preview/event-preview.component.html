<div class="event-preview">
  <div class="event-preview__hero" *ngIf="bannerUrl || displayName || endDateText">
    <div class="event-preview__banner" *ngIf="bannerUrl">
      <img [src]="bannerUrl" alt="Event banner" />
    </div>
    <div class="event-preview__intro">
      <h2 class="event-preview__title">{{ displayName }}</h2>
      <p class="event-preview__date" *ngIf="endDateText">Available until {{ endDateText }}</p>
    </div>
  </div>

  <div class="event-preview__empty" *ngIf="!components?.length">
    <p>No front page components yet. Add blocks to preview them here.</p>
  </div>

    <div class="event-preview__blocks" *ngIf="components?.length">
    <ng-container *ngFor="let comp of components; trackBy: trackBySortOrder">
      <ng-container *ngTemplateOutlet="renderBlock; context: { $implicit: comp }"></ng-container>
    </ng-container>
  </div>
</div>

<ng-template #renderBlock let-comp>
  <ng-container [ngSwitch]="typeOf(comp)">
    <section *ngSwitchCase="'banner'" class="preview-block preview-block--banner">
      <div class="preview-banner" [class.preview-banner--has-image]="comp.banner?.image">
        <ng-container *ngIf="comp.banner?.image; else bannerImagePlaceholder">
          <div class="preview-banner__background" [style.background-image]="'url(' + comp.banner?.image + ')'" ></div>
        </ng-container>
        <ng-template #bannerImagePlaceholder>
          <div class="preview-banner__placeholder" aria-label="Banner image placeholder">
            <span>Banner image</span>
          </div>
        </ng-template>

        <div class="preview-banner__overlay">
          <p class="preview-banner__text" [class.preview-banner__text--placeholder]="!hasContent(comp.banner?.textDesc)">
            {{ comp.banner?.textDesc || 'Text here' }}
          </p>

          <ng-container *ngIf="hasContent(comp.banner?.textOnButton); else bannerCtaPlaceholder">
            <a
              class="preview-banner__cta"
              [class.preview-banner__cta--inactive]="comp.banner && !comp.banner.isActive"
              [href]="comp.banner?.urlButton || '#'"
              target="_blank"
              rel="noopener"
            >
              {{ comp.banner?.textOnButton }}
            </a>
          </ng-container>
          <ng-template #bannerCtaPlaceholder>
            <span class="preview-banner__cta preview-banner__cta--placeholder">Text here</span>
          </ng-template>
        </div>
      </div>
    </section>

    <section *ngSwitchCase="'textbox'" class="preview-block preview-block--textbox">
      <div class="preview-textbox">
        <p class="preview-textbox__text" [class.preview-textbox__text--placeholder]="!hasContent(comp.textBox?.text)">
          {{ comp.textBox?.text || 'Text here' }}
        </p>
      </div>
    </section>

        <section *ngSwitchCase="'imagewithcaption'" class="preview-block preview-block--image">
      <div class="image-block">
        <div class="image-block__media">
          <ng-container *ngIf="comp.imageWithCaption?.image; else imageWithCaptionPlaceholder">
            <img [src]="comp.imageWithCaption?.image" alt="Image with caption" />
          </ng-container>
          <ng-template #imageWithCaptionPlaceholder>
            <div class="image-block__placeholder">Image</div>
          </ng-template>
        </div>
        <p class="image-block__caption" [class.image-block__caption--placeholder]="!hasContent(comp.imageWithCaption?.text)">
          {{ comp.imageWithCaption?.text || 'Text here' }}
        </p>
      </div>
    </section>

    <section *ngSwitchCase="'imagedesc'" class="preview-block preview-block--image-desc">
      <div class="image-desc">
        <div class="image-desc__media">
          <ng-container *ngIf="comp.imageDesc?.image; else imageDescPlaceholder">
            <img [src]="comp.imageDesc?.image" alt="Image with description" />
          </ng-container>
          <ng-template #imageDescPlaceholder>
            <div class="image-desc__placeholder">Image</div>
          </ng-template>
        </div>
        <div class="image-desc__content">
          <p class="image-desc__text" [class.image-desc__text--placeholder]="!hasContent(comp.imageDesc?.text)">
            {{ comp.imageDesc?.text || 'Text here' }}
          </p>
        </div>
      </div>
    </section>

    <section *ngSwitchCase="'gridtwocolumn'" class="preview-block preview-block--grid-two">
      <div class="preview-grid-two">
        <div class="preview-grid-two__card">
          <ng-container *ngIf="comp.gridTwoColumn?.leftImage; else leftGridTwoPlaceholder">
            <img [src]="comp.gridTwoColumn?.leftImage" alt="Left grid image" class="preview-grid-two__image" />
          </ng-container>
          <ng-template #leftGridTwoPlaceholder>
            <div class="preview-grid-two__image preview-grid-two__image--placeholder">Left image</div>
          </ng-template>
          <p class="preview-grid-two__caption" [class.preview-grid-two__caption--placeholder]="!hasContent(comp.gridTwoColumn?.leftText)">
            {{ comp.gridTwoColumn?.leftText || 'Text here' }}
          </p>
          <a
            *ngIf="hasContent(comp.gridTwoColumn?.leftUrl)"
            class="preview-grid-two__link"
            [href]="comp.gridTwoColumn?.leftUrl"
            target="_blank"
            rel="noopener"
          >
            View details
          </a>
        </div>
        <div class="preview-grid-two__card">
          <ng-container *ngIf="comp.gridTwoColumn?.rightImage; else rightGridTwoPlaceholder">
            <img [src]="comp.gridTwoColumn?.rightImage" alt="Right grid image" class="preview-grid-two__image" />
          </ng-container>
          <ng-template #rightGridTwoPlaceholder>
            <div class="preview-grid-two__image preview-grid-two__image--placeholder">Right image</div>
          </ng-template>
          <p class="preview-grid-two__caption" [class.preview-grid-two__caption--placeholder]="!hasContent(comp.gridTwoColumn?.rightText)">
            {{ comp.gridTwoColumn?.rightText || 'Text here' }}
          </p>
          <a
            *ngIf="hasContent(comp.gridTwoColumn?.rightUrl)"
            class="preview-grid-two__link"
            [href]="comp.gridTwoColumn?.rightUrl"
            target="_blank"
            rel="noopener"
          >
            View details
          </a>
        </div>
      </div>
    </section>

    <section *ngSwitchCase="'gridfourimage'" class="preview-block preview-block--grid-four">
      <div class="preview-grid-four">
        <div class="preview-grid-four__cell" *ngFor="let field of ['image1', 'image2', 'image3', 'image4']; let idx = index">
          <ng-container *ngIf="comp.gridFourImage?.[field]; else gridFourPlaceholder">
            <img [src]="comp.gridFourImage?.[field]" [alt]="'Grid image ' + (idx + 1)" />
          </ng-container>
          <ng-template #gridFourPlaceholder>
            <div class="preview-grid-four__placeholder">Image {{ idx + 1 }}</div>
          </ng-template>
        </div>
      </div>
    </section>

    <section *ngSwitchCase="'section'" class="preview-block preview-block--section">
      <div class="section-block">
        <div class="section-block__label">
          {{ comp.section?.components?.length ? 'preview section+component' : 'preview section' }}
        </div>
        <ng-container *ngIf="comp.section?.components?.length; else emptySectionBlock">
          <div class="section-block__children">
            <ng-container *ngFor="let child of comp.section?.components || []; trackBy: trackBySortOrder">
              <ng-container *ngTemplateOutlet="renderBlock; context: { $implicit: child }"></ng-container>
            </ng-container>
          </div>
        </ng-container>
        <ng-template #emptySectionBlock>
          <div class="section-block__empty"></div>
        </ng-template>
      </div>
    </section>

    <section *ngSwitchCase="'tablewithtopicanddesc'" class="preview-block preview-block--table">
      <div class="table-with-topic-desc">
        <p
          class="table-with-topic-desc__topic"
          [class.table-with-topic-desc__field--placeholder]="!hasContent(comp.tableWithTopicAndDesc?.title)"
        >
          {{ comp.tableWithTopicAndDesc?.title || 'Text here' }}
        </p>
        <p
          class="table-with-topic-desc__desc"
          [class.table-with-topic-desc__field--placeholder]="!hasContent(comp.tableWithTopicAndDesc?.textDesc)"
        >
          {{ comp.tableWithTopicAndDesc?.textDesc || 'Text here' }}
        </p>
      </div>
    </section>

    <section *ngSwitchCase="'onetopicimagecaptionbutton'" class="preview-block preview-block--one-topic">
      <div class="one-topic-card">
        <h3
          class="one-topic-card__title"
          [class.one-topic-card__field--placeholder]="!hasContent(comp.oneTopicImageCaptionButton?.title)"
        >
          {{ comp.oneTopicImageCaptionButton?.title || 'Text here' }}
        </h3>

        <div class="one-topic-card__media">
          <ng-container *ngIf="comp.oneTopicImageCaptionButton?.image; else oneTopicImagePlaceholder">
            <img [src]="comp.oneTopicImageCaptionButton?.image" alt="One topic image" />
          </ng-container>
          <ng-template #oneTopicImagePlaceholder>
            <div class="one-topic-card__placeholder">Image</div>
          </ng-template>
        </div>

        <p
          class="one-topic-card__desc"
          [class.one-topic-card__field--placeholder]="!hasContent(comp.oneTopicImageCaptionButton?.textDesc)"
        >
          {{ comp.oneTopicImageCaptionButton?.textDesc || 'Text here' }}
        </p>

        <a
          class="one-topic-card__button"
          [class.one-topic-card__button--placeholder]="!hasContent(comp.oneTopicImageCaptionButton?.textOnButton)"
          [class.one-topic-card__button--disabled]="!comp.oneTopicImageCaptionButton?.isActive"
          [attr.href]="comp.oneTopicImageCaptionButton?.isActive ? (comp.oneTopicImageCaptionButton?.url || '#') : '#'"
          [attr.aria-disabled]="comp.oneTopicImageCaptionButton?.isActive ? null : 'true'"
          target="_blank"
          rel="noopener"
        >
          {{ comp.oneTopicImageCaptionButton?.textOnButton || 'Text here' }}
        </a>
      </div>
    </section>

    <section *ngSwitchCase="'twotopicimagecaptionbutton'" class="preview-block preview-block--two-topic">
      <div class="two-topic">
        <div class="two-topic-card">
          <h3
            class="two-topic-card__title"
            [class.two-topic-card__field--placeholder]="!hasContent(comp.twoTopicImageCaptionButton?.leftTitle)"
          >
            {{ comp.twoTopicImageCaptionButton?.leftTitle || 'Text here' }}
          </h3>

          <div class="two-topic-card__media">
            <ng-container *ngIf="comp.twoTopicImageCaptionButton?.leftImage; else twoTopicLeftImagePlaceholder">
              <img [src]="comp.twoTopicImageCaptionButton?.leftImage" alt="Left topic image" />
            </ng-container>
            <ng-template #twoTopicLeftImagePlaceholder>
              <div class="two-topic-card__placeholder">Image</div>
            </ng-template>
          </div>

          <p
            class="two-topic-card__desc"
            [class.two-topic-card__field--placeholder]="!hasContent(comp.twoTopicImageCaptionButton?.leftTextDesc)"
          >
            {{ comp.twoTopicImageCaptionButton?.leftTextDesc || 'Text here' }}
          </p>

          <a
            class="two-topic-card__button"
            [class.two-topic-card__button--placeholder]="!hasContent(comp.twoTopicImageCaptionButton?.leftTextOnButton)"
            [class.two-topic-card__button--disabled]="!comp.twoTopicImageCaptionButton?.leftIsActive"
            [attr.href]="comp.twoTopicImageCaptionButton?.leftIsActive ? (comp.twoTopicImageCaptionButton?.leftUrl || '#') : '#'"
            [attr.aria-disabled]="comp.twoTopicImageCaptionButton?.leftIsActive ? null : 'true'"
            target="_blank"
            rel="noopener"
          >
            {{ comp.twoTopicImageCaptionButton?.leftTextOnButton || 'Text here' }}
          </a>
        </div>

        <div class="two-topic-card">
          <h3
            class="two-topic-card__title"
            [class.two-topic-card__field--placeholder]="!hasContent(comp.twoTopicImageCaptionButton?.rightTitle)"
          >
            {{ comp.twoTopicImageCaptionButton?.rightTitle || 'Text here' }}
          </h3>

          <div class="two-topic-card__media">
            <ng-container *ngIf="comp.twoTopicImageCaptionButton?.rightImage; else twoTopicRightImagePlaceholder">
              <img [src]="comp.twoTopicImageCaptionButton?.rightImage" alt="Right topic image" />
            </ng-container>
            <ng-template #twoTopicRightImagePlaceholder>
              <div class="two-topic-card__placeholder">Image</div>
            </ng-template>
          </div>

          <p
            class="two-topic-card__desc"
            [class.two-topic-card__field--placeholder]="!hasContent(comp.twoTopicImageCaptionButton?.rightTextDesc)"
          >
            {{ comp.twoTopicImageCaptionButton?.rightTextDesc || 'Text here' }}
          </p>

          <a
            class="two-topic-card__button"
            [class.two-topic-card__button--placeholder]="!hasContent(comp.twoTopicImageCaptionButton?.rightTextOnButton)"
            [class.two-topic-card__button--disabled]="!comp.twoTopicImageCaptionButton?.rightIsActive"
            [attr.href]="comp.twoTopicImageCaptionButton?.rightIsActive ? (comp.twoTopicImageCaptionButton?.rightUrl || '#') : '#'"
            [attr.aria-disabled]="comp.twoTopicImageCaptionButton?.rightIsActive ? null : 'true'"
            target="_blank"
            rel="noopener"
          >
            {{ comp.twoTopicImageCaptionButton?.rightTextOnButton || 'Text here' }}
          </a>
        </div>
      </div>
    </section>

    <section *ngSwitchCase="'aboutu'" class="preview-block preview-block--about">
      <div class="about-preview">
        <div
          class="about-preview__hero"
          [class.about-preview__hero--placeholder]="!hasContent(comp.aboutU?.imageTopic)"
        >
          <ng-container *ngIf="hasContent(comp.aboutU?.imageTopic); else aboutHeroPlaceholder">
            <img [src]="comp.aboutU?.imageTopic" alt="About highlight" />
          </ng-container>
          <ng-template #aboutHeroPlaceholder>
            <div class="about-preview__hero-placeholder">Hero image</div>
          </ng-template>
        </div>

        <div class="about-preview__body">
          <h3
            class="about-preview__title"
            [class.about-preview__title--placeholder]="!hasContent(comp.aboutU?.textTopic)"
          >
            {{ comp.aboutU?.textTopic || 'Text here' }}
          </h3>
          <p
            class="about-preview__description"
            [class.about-preview__description--placeholder]="!hasContent(comp.aboutU?.textDesc)"
          >
            {{ comp.aboutU?.textDesc || 'Text here' }}
          </p>

          <div class="about-preview__links">
            <div class="about-preview__link-card" [class.about-preview__link-card--clickable]="hasContent(comp.aboutU?.leftUrl)">
              <ng-container *ngIf="hasContent(comp.aboutU?.leftImage); else aboutLeftPlaceholder">
                <a
                  *ngIf="hasContent(comp.aboutU?.leftUrl); else aboutLeftImage"
                  [href]="comp.aboutU?.leftUrl"
                  target="_blank"
                  rel="noopener"
                >
                  <img [src]="comp.aboutU?.leftImage" alt="Left link" />
                </a>
                <ng-template #aboutLeftImage>
                  <img [src]="comp.aboutU?.leftImage" alt="Left link" />
                </ng-template>
              </ng-container>
              <ng-template #aboutLeftPlaceholder>
                <div class="about-preview__icon-placeholder">Image</div>
              </ng-template>
              <p *ngIf="hasContent(comp.aboutU?.leftText)" class="about-preview__caption">
                {{ comp.aboutU?.leftText }}
              </p>
            </div>

            <div class="about-preview__link-card" [class.about-preview__link-card--clickable]="hasContent(comp.aboutU?.rightUrl)">
              <ng-container *ngIf="hasContent(comp.aboutU?.rightImage); else aboutRightPlaceholder">
                <a
                  *ngIf="hasContent(comp.aboutU?.rightUrl); else aboutRightImage"
                  [href]="comp.aboutU?.rightUrl"
                  target="_blank"
                  rel="noopener"
                >
                  <img [src]="comp.aboutU?.rightImage" alt="Right link" />
                </a>
                <ng-template #aboutRightImage>
                  <img [src]="comp.aboutU?.rightImage" alt="Right link" />
                </ng-template>
              </ng-container>
              <ng-template #aboutRightPlaceholder>
                <div class="about-preview__icon-placeholder">Image</div>
              </ng-template>
              <p *ngIf="hasContent(comp.aboutU?.rightText)" class="about-preview__caption">
                {{ comp.aboutU?.rightText }}
              </p>
            </div>
          </div>
        </div>
      </div>
    </section>
<section *ngSwitchCase="'sale'" class="preview-block preview-block--sale">
  <ng-container *ngIf="saleState(comp.sale) as sale">
    <div class="sale-card" [class.sale-card--expired]="sale.expired">
      <div class="sale-card__content">
        <header class="sale-card__header">
          <h3 class="sale-card__title" [class.sale-card__title--placeholder]="!hasContent(comp.sale?.title)">
            {{ hasContent(comp.sale?.title) ? comp.sale?.title : saleFallbackTitle }}
          </h3>
          <p class="sale-card__subtitle" [class.sale-card__subtitle--placeholder]="!hasContent(comp.sale?.text)">
            {{ hasContent(comp.sale?.text) ? comp.sale?.text : saleFallbackSubtitle }}
          </p>
        </header>

        <div class="sale-card__pricing">
          <ng-container *ngIf="sale.hasPromoValue; else salePromoPlaceholder">
            <div class="sale-card__promo">
              <span class="sale-card__promo-value">{{ sale.promoValue }} {{ bahtSymbol }}</span>
            </div>
          </ng-container>
          <ng-template #salePromoPlaceholder>
            <div class="sale-card__promo sale-card__promo--placeholder" *ngIf="!sale.hasRegular">
              <span class="sale-card__promo-value">{{ saleFallbackAmountValue }} {{ bahtSymbol }}</span>
            </div>
          </ng-template>

          <div
            class="sale-card__regular"
            [class.sale-card__regular--striked]="sale.hasPromo"
            [class.sale-card__regular--highlight]="!sale.hasPromo"
            [class.sale-card__regular--placeholder]="!sale.hasRegular"
          >
            {{ sale.hasRegular ? sale.regularValue : saleFallbackAmountValue }} {{ bahtSymbol }}
          </div>
        </div>

        <div class="sale-card__countdown" *ngIf="sale.showCountdown">
          <span class="sale-card__countdown-label">{{ saleCountdownLabel }}</span>
          <div class="sale-card__timer">
            <ng-container *ngFor="let part of sale.countdownParts; let last = last">
              <span class="sale-card__timer-segment">{{ part }}</span>
              <span class="sale-card__timer-separator" *ngIf="!last">:</span>
            </ng-container>
          </div>
        </div>

        <p class="sale-card__deadline" [class.sale-card__deadline--placeholder]="sale.deadlinePlaceholder">
          {{ sale.deadlineText }}
        </p>

        <ng-container *ngIf="sale.buttonActive; else saleButtonInactive">
          <a
            class="sale-card__cta"
            [class.sale-card__cta--placeholder]="sale.buttonPlaceholder"
            [attr.href]="sale.buttonPlaceholder ? null : comp.sale?.url || '#'"
            [attr.target]="sale.buttonPlaceholder ? null : '_blank'"
            [attr.rel]="sale.buttonPlaceholder ? null : 'noopener'"
            [attr.aria-disabled]="sale.buttonPlaceholder ? 'true' : null"
          >
            {{ sale.buttonText }}
          </a>
        </ng-container>
        <ng-template #saleButtonInactive>
          <span class="sale-card__cta sale-card__cta--inactive">{{ sale.buttonText }}</span>
        </ng-template>

        <p class="sale-card__footer">
          {{ hasContent(comp.sale?.textFooter) ? comp.sale?.textFooter : saleFallbackFooter }}
        </p>
      </div>

      <div class="sale-card__logos" [class.sale-card__logos--placeholder]="!saleHasLogos(comp.sale)">
        <div class="sale-card__logo">
          <div class="sale-card__logo-image" [class.sale-card__logo-image--empty]="!hasContent(comp.sale?.leftImage)">
            <ng-container *ngIf="hasContent(comp.sale?.leftImage); else saleLeftLogoPlaceholder">
              <img [src]="comp.sale?.leftImage" alt="Left sale graphic" />
            </ng-container>
            <ng-template #saleLeftLogoPlaceholder>
              <span class="sale-card__logo-placeholder">Image</span>
            </ng-template>
          </div>
          <p class="sale-card__logo-text" [class.sale-card__logo-text--placeholder]="!hasContent(comp.sale?.leftText)">
            {{ hasContent(comp.sale?.leftText) ? comp.sale?.leftText : saleFallbackLogoText }}
          </p>
        </div>

        <div class="sale-card__logo">
          <div class="sale-card__logo-image" [class.sale-card__logo-image--empty]="!hasContent(comp.sale?.rightImage)">
            <ng-container *ngIf="hasContent(comp.sale?.rightImage); else saleRightLogoPlaceholder">
              <img [src]="comp.sale?.rightImage" alt="Right sale graphic" />
            </ng-container>
            <ng-template #saleRightLogoPlaceholder>
              <span class="sale-card__logo-placeholder">Image</span>
            </ng-template>
          </div>
          <p class="sale-card__logo-text" [class.sale-card__logo-text--placeholder]="!hasContent(comp.sale?.rightText)">
            {{ hasContent(comp.sale?.rightText) ? comp.sale?.rightText : saleFallbackLogoText }}
          </p>
        </div>
      </div>
    </div>
  </ng-container>
</section>

    <section *ngSwitchCase="'button'" class="preview-block preview-block--button">
      <a *ngIf="hasContent(comp.button?.textOnButton) && comp.button?.isActive"
         class="preview-button" [href]="comp.button?.url || '#'" target="_blank" rel="noopener">
        {{ comp.button?.textOnButton }}
      </a>
    </section>

        <section *ngSwitchCase="'formtemplate'" class="preview-block preview-block--form">
      <div class="form-preview">
        <div class="form-preview__title-row">
          <span class="form-preview__title">form</span>
        </div>

        <div class="form-preview__field">
          <label>Topic:</label>
          <input type="text" readonly [value]="comp.formTemplate?.topic || 'Text Here'" />
        </div>

        <div class="form-preview__divider"></div>

        <div class="form-preview__actions">
          <button type="button" class="form-preview__add" aria-label="Add form component">
            <i class="bi bi-plus-lg"></i>
          </button>
        </div>

        <button type="button" class="form-preview__cta">
          {{ comp.formTemplate?.textOnButton || 'Text Here' }}
        </button>

        <div class="form-preview__divider"></div>

        <div class="form-preview__popup">
          <h4>Popup after submit</h4>
          <div class="form-preview__popup-card">
            <div class="form-preview__popup-image">
              <ng-container *ngIf="comp.formTemplate?.popupImage; else popupPlaceholder">
                <img [src]="comp.formTemplate?.popupImage" alt="Popup preview" />
              </ng-container>
              <ng-template #popupPlaceholder>
                <div class="form-preview__popup-placeholder">
                  <img src="assets/icons/upload.png" alt="Upload placeholder" />
                </div>
              </ng-template>
            </div>
            <input type="text" readonly [value]="comp.formTemplate?.popupText || 'Text Here'" />
          </div>
        </div>

        <div class="form-preview__divider"></div>

        <div class="form-preview__footer">
          <button type="button" class="form-preview__save" aria-label="Save form template">
            Save &amp; Exit
          </button>
        </div>
      </div>
    </section>

    <section *ngSwitchDefault class="preview-block preview-block--generic">
      <h4>{{ comp.componentType }}</h4>
      <p>Preview not available for this component.</p>
    </section>
  </ng-container>
</ng-template>





